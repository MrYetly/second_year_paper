\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{rotating}

\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

\title{2nd year paper}
\author{Ivan Anich and Matt Van Essen}

\begin{document}
\maketitle



\section{Introduction}

What is the hole we are filling? (first to use a SWF in the allocation of public goods? And this is enabled by the generalized lindahl equilibrium concept)(How to improve mechanism design? That’s what research is ...)

Because we allow consumer surplus to be taken into account, we can use a social welfare function when determining the optimal tax schedule (but doesn’t Ramsey pricing do this?)

Discussion: we have proved the first welfare theorem but not the second?

\begin{itemize}
	\item big picture
	
	
	Public goods are an unusual economic subject in that they require we consider what is just, a normative topic in a field that usually focuses on the positive. Lindahl's (1919 [1958]) classical result concerning the optimal allocation of public goods is an opinion about what is just. He argues that a just outcome in the presence of a public good (hereafter a classical Lindahl outcome, or CLE) is one that provides the Pareto optimal level of the public good, raises individually rational taxes to finance the public good, and does so such that the taxes raised exactly equal the cost of the public good.
	
	
	
	
	
	
	
	
	\item contribution
	
	This concept has become a standard by which theories of the provision of public goods are measured, yet it is inadequate. It does not take into account the distribution of surplus created by the taxes it proscribes. As we show, this uncontrolled margin allows for outcomes that we argue are unjust. In order to build a more rigorous standard, we introduce the concept of a generalized Lindahl equilbrium (GLE).
	
	
	
	
	\item preview of results
	
	Our generalized Lindahl equilibrium has the Pareto optimality, individual rationality, and balanced budget of the classical result. In addition, it requires that each consumer must be given a personalized tax schedule instead of a single tax. If the preferences of a society concerning the surplus of its citizens can be represented by a social welfare function, this new margin of control allows those preferences to be included when calculating how to optimally provide a public good. We define the general form of such a problem and then solve an example with a CES welfare function. We then propose a mechanism for implementing generalized Lindahl equilibria when a central provider of the public good has incomplete information, and show that all of the Nash equilibria of games induced by this mechanism are generalized Lindahl equilibria.
	
		
	\item lit review
	
	The literature concerning the theory of public goods has both economic and philosophical beginnings. As mentioned, the work of Lindahl (1919 [1958]) has influenced this paper the most. He asked, when two parties have equal political power but differing valuations of a public good, what level of the public good should be provided, and how should the cost of producing it be shared between the two? He argued that cost shares should be determined by the parties’ marginal valuations of public good at the level it is provided, and that the level provided should be that which maximizes the net gain of both parties. Beyond Lindahl there were the political philosophical considerations of Wicksell (1896 [1958]). He pointed out that the definition of justice is itself a problem, and argues for a simple solution, unanimity: in order to achieve economic justice, a society should unanimously choose both how public funds should be spent and how the burden of raising those funds should be shared by its constituents. Both Wicksell and Lindahl believed the burden placed on any individual should be proportional to the benefit they received from public spending. Lindahl's argument has proved to be the source of far more economic research. Two fields of study relate directly to our work here: (1) extensions of the concept of Lindahl equilibrium, and (2) mechanisms capable of implementing Lindahl equilibria. 
	
	Extensions of Lindahl's original work were motivated by its lack of structure or inability to deal with certain economic settings. Foley (1970) rigorously stated Lindahl's result and then studied how it related to core theory (the core of an economy is the set of outcomes that optimizing agents converge to) and showed that all Lindahl equilibria are in the core of an economy. Kaneko (1977) pointed out that Lindahl's equilibrium does not dictate how profits should be redistributed, and so in the presence of profits (i.e. non-linear costs), not all Lindahl equilibria are in the core of the economy. He created a version of Lindahl's equilibrium that avoided this problem: he introduced the concept of a ratio equilibrium, in which the total costs of production of public goods are distributed among consumers according to a vector of ratios, such that the costs of provision are exactly covered and no firm earns profits. The problem of how profits should be redistributed would not be addressed until Mas-Colell and Silvestre (1989) created the concept of cost-share equilibrium, a theory of the ownership of the firm. Their model endogenously determines profit shares for a public firm, and shows that profits should be distributed according to the benefit an individual receives from a public good. This result built on Mas-Colell's (1980) previous work, in which he showed that Lindahl's original result holds when the costs of providing public goods has a non-linear structure: Lindahl's result is still efficient and able to be attained in a decentralized manner. Later, Diamantaras and Gilles (1996) showed that this continues to hold in the presence of an arbitrary number of private goods.  
	
	Theories of mechanism design have studied the free rider problem inherent in public goods, with attention given to implementing Lindahl allocations in particular. Consumers have an incentive to misrepresent their valuations of a public good, and so benefit from the contributions of others towards its provision. When a government or social planner does not know the private valuations of individuals, a mechanism can be used to theoretically arrive at an optimal outcome. The mechanisms of Groves and Ledyard (1977), Hurwicz (1979), and Walker (1981) all provided solutions to the free rider problem. Groves and Ledyard's mechanism is incentive compatible and was shown to implement the first and second theorems of welfare economics as well, but it is not always individually rational. Walker's mechanism addressed this issue by designing a mechanism whose outcomes were always Lindahl allocations, and so individually rational by definition. Walker's economic setting and mechanism provide the inspiration for the economic setting and mechanism found in this paper. Varian (1994a) provides a mechanism inspired by Coase-ian negotiation that addresses the problem of how to set a Pigovian tax when net social benefits are unknown. Varian (1994b) then goes on to show that when contributions to a public good are made sequentially, total contributions are never more than they are when made simultaneously. He introduces a mechanism capable of implementing Lindahl allocations in a sequential-move game involving cross-subsidization.
	
	More recently, mechanism design theory concerning Lindahl allocations has shifted its focus from theoretical existence and implementability, to experimental implementability. In an experimental setting, participants often do not engage in equilibrium play: they do not carry out the best responses assumed in a Nash equilibrium. Participants instead begin out of equilibrium, and adjust their behavior as they play the same game repeatedly. If the theory behind a mechanism states that these players' responses should move toward a Nash equilibrium as they learn, then that equilibrium is stable. Experimental evidence suggests that such stable equilibria are more likely to be converged upon in an experimental setting (Chen 2002). Milgrom and Roberts (1990) derived a way to compute the upper and power bounds of the set of undominated strategies for supermodular games. If the set of undominated strategies is a singleton, then they argued that out of equilibrium play should eventually converge to a single Nash equilibrium, and that this convergence was robust to a number of different assumptions about learning. Mathevet (2010) attempts to use supermodular games to solve the dilemma in mechanism design that holds a mechanism can have either a simple structure or lead to a single equilibrium.  He introduces a method of mechanism design in which the interval between Nash equilibria is minimized. His method creates mechanisms robust to bounded rationality (i.e. out of equilibrium play). Healy and Mathevet (2012) go on to show that supermodularity is not always a sufficient condition for stability. They introduce contraction mechanisms. Such mechanisms lead to best response functions that are contraction mappings, which sequentially reduce the set of undominated strategies as agents repeatedly play a game and so lead to stable equilibria. Chen (2002) invents a family of supermodular mechanisms that achieves Lindahl allocations in a general economic environment. However, Van Esson (2013) shows that the supermodularity of Chen's mechanism is not a sufficient condition for stability. In the spirit of Chen and Healy and Mathevet, he addresses this issue by creating a mechanism that leads to stable Lindahl equilibria by ensuring that all best response mappings are contractions. 
	
	
	
	\item structure
\end{itemize}


\section{Model}

A fairly simple economic environment will provide an adequate setting. There will be \(i = 1, ..., n \geq 2\) individuals in the economy, each represented by a convex consumption set \(C_i = \mathbb{R}_i^2\) and an initial endowment of a private good \(\omega_i > 0\). They consume bundles of a public good \(x\) a private good \(y_i\), and in doing so gain utility according to utility functions of the following form.

\begin{equation}
u_i(x, y_i) = \int_0^x v_i(t) dt + y_i
\label{set_util}
\end{equation}

This functional form simplifies later analysis, as \(\frac{\partial u_i}{\partial x} = v_i(x) > 0\) and \(\frac{\partial^2 u_i}{\partial x^2} = v_i'(x) < 0\) for \(x \in \mathbb{R}_+\). \(v_i\) is the the marginal rate of substitution between the public good and the private good for individual \(i\). 

The public good is produced in a constant returns to scale production process that uses the private good as an input: for each unit of the public good produced, \(c\) of the private good must be sacrificed. If \(\Omega = \sum_i \omega_i\), then the most public good that can be produced is \(\frac{\Omega}{c}\). An allocation in this economy is then an \((n+1)\)-tuple \((x, y_1, ..., y_n) \in \mathbb{R}_+^{n+1}\). 

We shall assume that there is a unique Pareto optimal allocation in the economy, such that a unique level of provision of the public good is Pareto optimal. This is to say that there is a level of the public good that satisfies the Samuelson marginal condition: \(\sum_i v_i(x^{PO}) = c\) for \(x \in [0, \frac{\Omega}{c}]\). To ensure this, we assume \(\sum_i v_i(0) > c\) and \(\sum_i v_i(\frac{\Omega}{c} < c)\). In addition, we shall also assume that the initial endowments of the private good are sufficiently large for feasible provision of \(x^{PO}\), \(\omega_i \geq v_i(0) x^{PO}\).

\subsection{Classical Lindahl Equilibrium} \label{CLE}

An unregulated market cannot efficiently provide a public good. A firm cannot earn revenue by selling the right to consume a public good because it cannot prevent the consumption of a public good by those who have not paid for it. Consumers face a strong incentive not pay for the provision of a public good because once the public good is provided the consumption of it by one individual does not prevent the consumption of it by another. These are the usual non-rival and non-excludable characteristics of a public good. Some sort of market regulation is required to elicit and finance the efficient provision of the public good. Individuals can be taxed and production can be centralized by a government. One theoretical equilibrium that allows a Pareto optimal amount of the public good to be provided is a classical Lindahl equilibrium.

A classical Lindahl equilibrium uses individualized taxes, known as Lindahl prices, to raise revenue for the provision of a public good. It finds the socially optimal level of the public good and then charges each consumer their marginal valuation of the public good at the socially optimal level. With constant marginal costs of provision and downward sloping demand curves, a classical Lindahl equilibrium ensures that it is individually rational for individuals to pay the tax levied upon them and that the sum of such taxes exactly covers the provision of the public good. 

For example, consider an instance of the economic setting outlined above with \(n=2\), \(c=5\), and the following utility functions for the two individuals 

\begin{align*}
u_1(x, y_1) &= \int_0^x \left( 20 - 2t \right) dt + y_1 \\
u_2(x, y_2) &= \int_0^x \left( 6 - 0.1t \right) dt + y_2
\end{align*}

\noindent And so

\begin{align*}
v_1(x) &= 20 - 2x \\
v_2(x) &= 6 - 0.1x
\end{align*}

\begin{figure}
\center{Classical Lindahl Equilibrium}
\includegraphics[width=\textwidth]{classical_lindahl_plots.pdf}
\caption{An example of a classical Lindahl Equilbrium for \(n=2\) consumers. The vertical grey dotted line is located at the Pareto optimal level of the public good. Consumer 1 is charged nothing, while consumer 2 is charged 5 units of the private good.}
\label{classical_lind}
\end{figure}

This setting is shown graphically in figure \ref{classical_lind}. To construct a classical Lindahl equilibrium we would first find the Pareto optimal level of the public good, \(x^{PO}\), via the Samuelson marginal condition, \(\sum_i v_i(x^{PO}) = c\). Then, because the private good is a numeraire, the tax \(t_i\) levied upon each individual would be equal to their marginal rate of substitution evaluated at \(x^{PO}\), \(t_i = v_i(x^{PO})\). Here, the Pareto optimal amount of the public good is \(x^{PO} = 10\). The marginal benefit of the public good at this level is 0 for consumer 1 and 5 for consumer 2, and so \(t_1 = 0\) and \(t_2 = 5\). 

We can see that the classical Lindahl equilibrium leaves both consumers better off than they would be if no public good was provided, so the outcome is indeed individually rational. It also raises tax revenue that covers the cost of providing the public good. But, it is also clear that consumer 1 is left far better off than consumer 2, even though consumer 2 incurs all of the costs.

This illustrates how a Lindahl equilibrium does not take into account the distribution of surplus among consumers when optimizing the provision of a public good. Even though the outcome is individually rational, some consumers may be left far better off than others. In order to address this flaw, we introduce the concept of a generalized Lindahl equilibrium. 

\section{Generalized Lindahl Equilibrium}

A classical Lindahl equilibrium must be individually rational and raise tax revenue equal to the cost of provision of the public good. As stated in the previous section, the disregard of consumer surplus in such an equilibrium can lead to unfair outcomes. In this section, I explain how a generalization of the classical Lindahl result can allow a social planner to construct far more equitable outcomes. 

The unjustness of the classical result can be thought of as a result of the linearity of prices faced by consumers. Consumers are charged one personalized tax across all margins of consumption of the public good; the surplus they attain at each margin is then the difference between their marginal valuations and these constant taxes. If those taxes were non-linear, a more equitable outcome could be achieved. A tax schedule could be created such that the equity of the benefits accruing to each consumer at each margin of provision of the public good were taken into account. This allowance for non-linear taxation \textit{is} the generalization of the classical Lindahl equilibrium that constitutes the purpose of this paper.  

A generalized Lindahl equilibrium sees each consumer receive a personalized tax schedule, instead of a single personalized tax. The outcome is still individually rational and covers the cost of provision, as in the classical case, but now a central planner or government can manipulate the personalized price schedules to distribute consumer surplus as they see fit. 

\begin{definition}
A profile of individualized price schedules induces a generalized Lindahl equilibrium if it is (1) individually rational for each individual to demand the Pareto optimal amount of the public good and (2) if the cost of providing the public good is exactly covered by taxes paid by each individual. 
\end{definition} 

Note that a generalized Lindahl equilibrium is agnostic about the specific distribution of consumer surplus. It merely requires that a tax schedule is administered. Consequently, there are many generalized Lindahl equilibria capable of providing the Pareto optimal level of the public good. The social planner can chose an outcome that obtains a desired distribution from among all feasible generalized Lindahl equilibria. This will be explored further in the next section.

For now I shall discuss some necessary conditions for a generalized Lindahl equilibrium, using the economic setting described above for the exposition. A personalized tax schedule is defined as a function \(p_i : \mathbb{R} \rightarrow \mathbb{R}\), such that the total tax revenue collected from individual \(i\) for a level of provision of the public good \(x\) is \(T_i(x) = \int_0^x p_i(t) dt\). The budget constraint of a customer is then \( \int_0^x p_i(t) dt + y_i = \omega_i \). If we solve for the level of the private good in terms of the level of the public good given their initial endowment, \(y_i(x)\), and substitute this into their utility function, we can express their utility in terms of their initial allocation and the level of public good provided.

\begin{equation}
u_i(x, y_i(x)) = u_i \left( x, \omega_i - \int_0^x p_i(t) dt \right) = \int_0^x \left[ v_i(t) - p_i(t) \right] dt + \omega_i
\label{gle_util}
\end{equation}

\noindent From this we get the fist of two conditions for individual rationality: 

\begin{equation}
\left. \frac{\partial u_i(x, y_i(x))}{\partial x} \right|_{x=x^{PO}} = 0 \rightarrow v_i(x^{PO}) = p_i(x^{PO})
\label{gen_ir1}
\end{equation}

\noindent The prices charged at the margin for the public good in a generalized Lindahl equilibrium must be the Lindahl prices from the classical Lindahl equilibrium. The second condition for individual rationality requires that customers are indeed better off at the Pareto optimal outcome than they would be with zero public good provided.

\begin{equation}
u_i(x^{PO}, y_i(x^{PO})) \geq u_i(0, y_i(0))
\label{gen_ir2}
\end{equation}


\noindent And finally, for the tax revenues to cover the cost of provision, we must have

\begin{equation}
\sum_i  \int_0^{x^{PO}} p_i(t) dt = cx^{PO}
\label{gen_cost}
\end{equation}

\noindent Equations \ref{gen_ir1}, \ref{gen_ir2}, and \ref{gen_cost} must all hold for an equilibrium to qualify as a generalized Lindahl equilibrium. In the next section, they shall function as constraints on a social welfare problem facing a social planner who wants to optimally provide a public good, and who has CES preferences over the individual consumer surpluses it oversees.


\subsection{Generalized Lindahl Equilibrium under a CES Social Welfare Function}

We can imagine a society's preferences over the distribution of surplus being encoded into a marginal social welfare function. The maximization of the integral of this social welfare function, subject to the conditions necessary for a generalized Lindahl equilibrium stated in the previous section, is a theoretical representation of how such a society could provide a public good in an equitable way. 

In general, let's say that this marginal social welfare function is a function of the marginal consumer surpluses of each individual in a society: \(W : \mathbb{R}_+^n \rightarrow \mathbb{R}\) is differentiable, quasiconcave, increasing in each of its arguments, and \(W(\boldsymbol{0}) = 0\). The restriction that \(W\) is defined on the non-negative elements of \(\mathbb{R}^n\) introduces a new constraint, \(v_i(t) - p_i(t) \geq 0 ~ \forall ~ t \in [0, x^{PO}]\), which must hold for integration to be defined. The combination of this new constraint and  \(v_i(t) - p_i(t) < 0 ~ \forall ~ t > x^{PO}\) provide a sufficient condition for individual rationality, ensuring that any optimal allocation of the public good will be individually rational. The problem facing a society is then

\begin{align}
\max_{\{ p_i(t)\}_{i=1}^n} &\int_0^{x^{PO}} W(v_1(t) - p_1(t), ..., v_n(t) - p_n(t)) dt 
\\
s.t. ~ & v_i(x^{PO}) = p_i (x^{PO}) 
\\
& v_i(t) - p_i(t) \geq 0 &\forall ~t \in [0, x^{PO}] \label{cons_pos}
\\
& v_i(t) - p_i(t) < 0 &\forall ~t > x^{PO} \label{cons_neg}
\\
& \int_0^{x^{PO}} \sum_{i=1}^n p_i(x) dx = cx^{PO} 
\end{align}

I will now solve a specific example of this problem in which society has CES preferences over individual marginal surplus.  

\begin{align}
\max_{\{ p_i(t)\}_{i=1}^n} &\int_0^{x^{PO}} \left[ \sum_{i=1}^n \beta_i (v_i(x) - p_i(x))^\alpha \right]^{\frac{1}{\alpha}} dx \label{objective}
\\
s.t. ~ & v_i(x^{PO}) = p_i (x^{PO}) \label{margin_constraint}
\\
& \int_0^{x^{PO}} \sum_{i=1}^n p_i(x) dx = cx^{PO} \label{iso_constraint}
\end{align}

\(\beta_i\) is an arbitrary weight for individual \(i\)'s surplus and \(-\infty > \alpha \leq 1\). Equation \ref{margin_constraint} ensures that the level of the public good provided is the level demanded by each individual, and equation \ref{iso_constraint} ensures that tax revenue will equal the cost of provision. In this instance, \ref{cons_pos} and \ref{cons_neg} will not bind. 

This is a calculus of variations problem. Throughout its solution any dependency on \(x\) is suppressed. The necessary conditions to solve it are \ref{margin_constraint}, \ref{iso_constraint}, and \(n\) Euler equations, one for each individual:

\begin{equation}
\lambda = -\beta_j (v_j - p_j)^{\alpha - 1} \left[ \sum_{i=1}^n \beta_i (v_i - p_i)^\alpha \right]^{\frac{1- \alpha}{\alpha}} \quad \forall ~ j = 1, ..., n
\end{equation}

\noindent \(\lambda\) is the Lagrangian multiplier on the iso-perimetric constraint \ref{iso_constraint}. If we set the Euler equations for individuals 1 and 2 equal to each other, we get 

\[
\left( \frac{\beta_2}{\beta_1} \right)^\sigma (v_1 - p_1) = v_2 - p_2
\]

\noindent Where \(\sigma = \frac{1}{1 - \alpha}\) is the elasticity of substitution between the surplus of any two individuals. I will define \( \Omega_{21} = \left( \beta_2 / \beta_1 \right)^\sigma\). Substituting this in and rearranging, we get

\[
p_2 - \Omega_{21} p_1 = v_2 - \Omega_{21}v_1
\]

\noindent If we perform a similar manipulation among all \(n\) Euler conditions, we are left with a system of \(n-1\) equations

\begin{align*}
p_2 - \Omega_{21} p_1 &= v_2 - \Omega_{21}v_1
\\
p_3 - \Omega_{32} p_2 &= v_3 - \Omega_{32}v_2
\\
&\vdots
\\
p_n - \Omega_{n,n-1} p_{n-1} &= v_n - \Omega_{n,n-1}v_{n-1}
\end{align*}

\noindent One way to ensure that the iso-perimetric constraint holds is to assume that the taxes levied at each marginal provision of the public good are always equal to the marginal cost of production.

\begin{equation}
p_1 + p_2 + ... + p_n = c
\label{iso_simp}
\end{equation}

\noindent With this and the system of \(n-1\) equations above, we now have a system of \(n\) equations that we can use to solve for closed-form solutions of individualized price schedules (the full solution is detailed in the appendix). Those solutions are

\begin{equation}
p_j =  v_j - \frac{\beta_j\strut^\sigma}{\sum_{i=1}^n \beta_i\strut^\sigma} \left[  \sum_{i =1}^n (v_i)  - c \right]
\label{closed_p}
\end{equation}

In this solution, the optimal personalized tax schedule has two parts. Individuals are taxed at each margin according to their private valuation at that margin, \(v_j\). This baseline is then adjusted by what fraction of the marginal net social benefit (\( \sum_{i =1}^n (v_i)  - c\)) is redistributed back to them, as dictated by what share their social weights have in society (\(\beta_j\strut^\sigma / \sum_{i=1}^n \beta_i\strut^\sigma\)). The redistributive nature of the tax schedules is made clear when the marginal net benefit earned under them is stated:

\[
b_j \equiv v_j - p_j = \frac{\beta_j\strut^\sigma}{\sum_{i=1}^n \beta_i\strut^\sigma} \left[  \sum_{i =1}^n (v_i)  - c \right]
\]

\noindent The baseline outcome is that individuals are taxed such that all of their private surplus is taken away, and it is only the redistribution of net \textit{social} benefit that leads to any individual being better off in the end. 



For very small elasticities of substitution the complementarity of individuals' surplus in the eyes of society overrides their social weights. They are treated more of less equally. When \(\sigma = 0\), consumer surpluses are perfect complements and we are left with the following tax schedules.

\[
p_j = v_j - \frac{1}{n} \left[ \sum_{i =1}^n (v_i) - c \right]
\]

\noindent When society distributes consumer surplus equally, individuals are left with equal shares of the net social benefit at each margin of provision of the public good. When \(\sigma=1\) the original marginal social welfare function becomes a Cobb-Douglas function and the personalized tax schedules become

\[
p_j = v_j - \frac{\beta_j}{\sum_{i=1}^n \beta_i} \left[  \sum_{i =1}^n (v_i) - c \right]
\]

\noindent The weights now have an effect because individuals' surpluses are substitutable. An individual with a higher social weight now receives a larger share of the net social benefit at each margin because it is optimal for society to substitute their surplus for others'. As \(\sigma \rightarrow \infty\), individuals' surpluses become perfect substitutes. Those with the highest social weight (\(j \in J_{max}\), where \( J_{max} \equiv \{j : \beta_j = \max \{\beta_i\}_1^n\}\)) receive all of the marginal net social benefit. Among these individuals, society is indifferent about the distribution of surplus. I shall assume that it is redistributed evenly among them.  Those with lower weights receive no redistribution. 

\[
p_j = \begin{cases}
v_j - \frac{1}{\left| J_{max} \right|} \left[ \sum_{i =1}^n (v_i) - c \right] & if ~ j \in J_{max} \\
v_j & else
\end{cases}
\]


Figure \ref{CES_plots} plots some examples of \ref{closed_p} for various values of \(\sigma\). I reuse the setting used to expose the unjustness of the classical Lindahl equilibrium in section \ref{CLE}: there are two consumers with \(v_1(x) = 20 - 2x\) and \(v_2(x) = 6 - 0.1x\), the marginal cost of providing the public good is 5, and a Pareto optimal amount of it is 10. \(\beta_1\) is 10 and \(\beta_2\) is 1. 

\begin{sidewaysfigure}
\center{Price Schedules, Marginal Benefits, and Marginal Cost in a 2 Consumer Setting for Various Values of \(\sigma\)}
\includegraphics[width = \textwidth]{lindahl_plots}
\caption{Above are several representations of price schedules leading to generalized Lindahl equilibria for a setting with two individuals and various values of \(\sigma\), the elasticity of substitution between the surpluses of any two individuals. The marginal benefit functions are \(v_1(x) = 20 - 2x\), \(v_2(x)=6 - x/10\). Social welfare weights are \(\beta_1 = 10\) and \(\beta_2 = 1\). Marginal cost of providing the public good is 5, and the Pareto optimal amount of it is 10.}
\label{CES_plots}
\end{sidewaysfigure}

\section{Generalized Walker Mechanism}

As is often the case in the theory of public goods, one of the strongest assumptions made here is that private valuations of the public good are known by the social planner. In an effort to relax this assumption, I now describe a mechanism a social planner could implement in order to obtain a Lindahl equilibrium without knowledge of individuals' private valuations. When this mechanism is implemented, it induces a generalized Lindahl equilibrium. In general, a mechanism is defined by the messages agents are allowed to choose and the outcome functions that convert these messages into outcomes. 

In our environment (with a slight change of notation) an outcome is specified by a level of the public good \(x\) and a set of personalized tax schedules for each individual \(\tau_i\) such that each individual pays in total \(T_i(x) = \int_0^x \tau_i(t) dt\). The messages sent by individuals \(i=1, ..., n\) are continuous functions \(p_i : \mathbb{R} \rightarrow \mathbb{R}\). The list of all of these messages is a message profile \(\mathbf{p} = (p_1, ..., p_n)\). There are \(n+1\) outcome functions, one to determined the provision of the public good,  \(\mathcal{X} : \prod_i^n C(\mathbb{R}) \rightarrow \mathbb{R}\), and \(n\) to determined what tax schedules are to be administered, \(\mathcal{T}_i : \prod_i^n C(\mathbb{R}) \rightarrow C(\mathbb{R})\). The functional forms of these outcome functions are
	
	
\begin{align}
\mathcal{X}(\mathbf{p}) &= \argmax_{t \geq 0} \int_o^t \sum_{i=1}^n p_i(m) dm \label{oc_x} \\
\mathcal{T}_i(\mathbf{p}) &= \frac{c}{n} + p_{i+2} - p_{i+1} \label{oc_t} 
\end{align}	
	
\noindent Note that the subscript \(i + j\) is understood to be a modulo operation, \(n+j= j\), and \(c\) is once again the marginal cost of the public good (this follows the mechanism design in Walker (1981)).

 This mechanism defines a game form: when preferences are added to it a game is induced. The outcome functions \ref{oc_x} and \ref{oc_t} each are designed to influence what strategies are used to satisfy these preferences in such a game. First, when all other messages \(p_{-j}\) are taken as given, \ref{oc_x} allows any individual message \(p_j\) to demand a certain level of the public good: no matter what function results from \(\sum_{i \neq j} p_i(m)\), the addition of \(p_j\) can create an integrand \(\sum_{i=1}^n p_i(m)\) such that \(\mathcal{X}(\mathbf{p})\) produces any outcome \(x\) an individual \(j\) desires. Second, \ref{oc_t} states that the tax schedule that will be administered to any individual does not depend on their own message. In tandem, these two outcome functions mean that a utility optimizing agent playing a game induced by this mechanism only has one margin of optimization, the public good. I now add the preferences from the economic setting described in section \ref{CLE} in order to induce and analyze the resulting game.

\begin{proposition}
At any Nash equilibrium induced by our mechanism, any equilibrium outcome \((\vec{\tau}, x)\) coincides with a generalized Lindahl outcome and is Pareto optimal.
\end{proposition}

\begin{proof}
To be a generalized Lindahl outcome, each individual must be given a personal tax schedule, the cost of providing the public good must be covered, and the allocation \((\vec{\tau}, x)\) must be individually rational and Pareto optimal. If the budget constraint of a player is \(\int_0^x p_i(t) dt + y_i = \omega_i \) and their utility function is \(u_i(x, y_i)\), then each player faces the following utility maximization problem:

\begin{align*}
&\max_{p_i(x)} ~u_i \left( x, \omega_i - \int_0^x \tau_i(t) dt\right)
\\
&s.t.~ x = \argmax_{t \geq 0} \int_o^t \sum_{i=1}^n p_i(m) dm
\end{align*}

\noindent or

\begin{align*}
&\max_{p_i(x)} ~ u_i \left( x, \omega_i - \int_0^x \left[ \frac{c}{n} + p_{i+2}(t) - p_{i+1}(t) \right] dt \right) \numberthis 
\\
&s.t.~ x = \argmax_{t \geq 0} \int_o^t \sum_{i=1}^n p_i(m) dm \numberthis \label{x_cons}
\end{align*}

The problem can be simplified further, as a choice over \(x\). The objective function does not \textit{directly} depend on an individual's choice of message \(p_i\), but the amount of the public good provided does, via the constraint \ref{x_cons}: if a player understands \(x\) is chosen according to \ref{x_cons}, then they understand that the following first order condition \(\sum_{i=1}^n p_i(x) = 0\) must hold. Each player takes all other messages \(p_{-i}\) as given, and submits a \(p_i\) such that the maximizing argument of \ref{x_cons} is the \(x\) they deem optimal. Only by this level of \(x\) does \(p_i\) affect their utility; the problem can be rewritten as:

\begin{equation}
\max_x ~ u_i \left( \omega_i - \int_0^x \left[ \frac{c}{n} + p_{i+2}(t) - p_{i+1}(t) \right] dt, x \right) 
\end{equation}

\noindent The first order condition for utility maximization is: 

\begin{align*}
\frac{u_{i, x}(y(x), x)}{u_{i, y_i}(y(x),x)} &= \frac{c}{n} + p_{i+2}(x) - p_{i+1}(x) \numberthis \label{foc}
\end{align*}

\noindent Equation \ref{foc} states that in a Nash equilibrium a best responding individual submits a message \(p_i\) such that the level of the public good the message implicitly demands equates their marginal rate of substitution to their personalized tax at the margin demanded. If we assume that \(u_i\) is quasi-concave (we can't, sign/magnitude of \(p_{i+2} - p_{i+1}\) matters) then \ref{foc} defines a global maximum, and we can state that a Nash equilibrium is individually rational for all players to accept. 

%need proof of quasi-concavity argument, SOC?

Note that the best response message \(p_i\) is not unique. \ref{foc} only applies at a single point, the level of the public good provided.  This is true because the only feature of \(p_i\) relevant to utility maximization is where it dictates \(\sum_{i=1}^n p_i(x) = 0\). Consequently, this is also the only feature relevant to the achievement of a Nash equilibrium. Therefore, a best response \(p_i\) could be any integrable function that satisfies the point constraint \ref{foc}.
 
%is global maximum (SOC) required to say that messages pi are not unique? 
 
The sum of all \(n\) first order conditions is 

\begin{equation}
\sum_{i=1}^n \frac{u_{i, x}(y(x), x)}{u_{i, y_i}(y(x), x)} = c
\label{eq}
\end{equation}

\noindent The modulo dependence of the personalized taxes creates a cancellation that leads to the sum of all marginal rates of substitution equalling the marginal cost of provision: the outcome is Pareto optimal. 

The final qualification left to prove is that the cost of provision is covered. This is true via the construction of the personalized tax outcome function. No matter what messages are submitted, the sum of all tax schedules \(\tau_i\) equals marginal cost at every single margin, \(\sum_{i=1}^n \tau_i = c\). 

Any Nash equilibrium of the game induced by our mechanism is a generalized Lindahl outcome: the outcome provides individualized tax schedules, covers the cost of provision of the public good, and is Pareto optimal and individually rational. This concludes the proof.

\end{proof}



\section{Discussion}


\section{Appendix}

The solution will take place as follows: I will solve for \(p_1\) in terms of \(p_2, v_1\) and \(v_2\), and then substitute \(p_1\) into \ref{iso_simp}; I will iterate this process two more times, substituting equations for \(p_2\) and \(p_3\) into \ref{iso_simp}; at that point a pattern will emerge that will allow me to extrapolate a closed-form solution for to \(p_n\), and then for \(p_{n-1}\); finally, I will use the pattern observable in the solutions for \(p_n\) and \(p_{n-1}\) solution to deduce a closed form solution for \(p_i\) in general.

As stated, first solve for \(p_1\) 
	
\[
p_1 = \frac{-v_2}{\Omega_{21}} + v_1 + \frac{p_2}{\Omega_{21}}
\]

\noindent Substitute into \ref{iso_simp}

\[
\left( \frac{-v_2}{\Omega_{21}} + v_1 + \frac{p_2}{\Omega_{21}} \right) + p_2 + p_3 + ... + p_n = c
\]

Combine terms, keeping prices and marginal benefits organized, and note that \(\Omega_{ij} = \Omega_{ji}^{-1}\). We get our first instance of a pattern.

\[
\left( 1 + \Omega_{12} \right) p_2 + p_3 + ... + p_n + v_1 - \Omega_{12} v_2 = c
\]

Iterating, solve for \(p_2\) in terms of \(p_3, v_2\) and \(v_3\) using the equation relating \(p_2\) to \(p_3\) from our system of equalities. Substitute into above.

\[
\left( 1 + \Omega_{12} \right) \left( \frac{-v_3}{\Omega_{32}} + v_2 + \frac{p_3}{\Omega_{32}} \right) + p_3 + p_4 + ... + p_n + v_1 -\Omega_{12} v_2 = c
\]

Combine terms again, and note that \(\Omega_{Ki} / \Omega_{Kj} = \Omega_{ij}\). A nice cancellation occurs. We get a second instance of the pattern.

\[
\left( 1 + \Omega_{23} + \Omega_{13} \right) p_3 + p_4 + ... + p_n + v_1 + v_2 - (\Omega_{23} + \Omega_{13}) v_3 = c
\]

Iterate one last time, substituting for \(p_3\).

\[
\left( 1 + \Omega_{23} + \Omega_{13} \right) \left(  \frac{-v_4}{\Omega_{43}} + v_3 + \frac{p_4}{\Omega_{43}} \right) + p_4 + p_5 + ... + p_n + v_1 + v_2 - (\Omega_{23} + \Omega_{13}) v_3 = c
\]

Combine terms, and we get a third instance of the pattern.

\[
\left( 1 + \Omega_{34} + \Omega_{24} + \Omega_{14} \right) p_4 + p_5 + ... + p_n + v_1 + v_2 + v_3 - (\Omega_{34} + \Omega_{24} + \Omega_{14}) v_4 = c
\]

Let's quickly look at all three instances of the pattern together.

\begin{align*}
&\left( 1 + \Omega_{12} \right) p_2 + p_3 + ... + p_n + v_1 - \Omega_{12} v_2 = c
\\
&\left( 1 + \Omega_{23} + \Omega_{13} \right) p_3 + p_4 + ... + p_n + v_1 + v_2 - (\Omega_{23} + \Omega_{13}) v_3 = c
\\
&\left( 1 + \Omega_{34} + \Omega_{24} + \Omega_{14} \right) p_4 + p_5 + ... + p_n + v_1 + v_2 + v_3 - (\Omega_{34} + \Omega_{24} + \Omega_{14}) v_4 = c
\end{align*}

By extrapolation, and noting that \(\Omega_{ii} = 1\), \(p_n\) must be implicitly defined by

\[
p_n \sum_{i=1}^n \Omega_{in} + \sum_{i=1}^{n-1} v_i - v_n \sum_{i=1}^{n-1} \Omega_{in} = c
\]

Solving for \(p_n\), we get

\begin{equation}
p_n = \left( \sum_{i=1}^n \Omega_{ni} \right)^{-1} \left[  c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{ni}\right]
\end{equation}

To get a closed form solution for any \(p_i\), I'll first use 6 to solve for \(p_{n-1}\) using the equation from our system of equations that relates \(p_{n-1}\) to \(p_n\). Then with closed from solutions for both \(p_n\) and \(p_{n-1}\), a pattern emerges that I use to solve for the general closed form solution for \(p_i\).

First, solve for \(p_{n-1}\). We know that

\[
p_{n-1} = \frac{-v_n}{\Omega_{n,n-1}} + v_{n-1} + \frac{p_n}{\Omega_{n,n-1}}
\]

Substitute in 6. Step by step simplification:

\begin{align*}
p_{n-1} &= \frac{-v_n}{\Omega_{n,n-1}} + v_{n-1} + \frac{1}{\Omega_{n,n-1}} \left( \sum_{i=1}^n \Omega_{in} \right)^{-1} \left[  c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in}\right]
\\
& =  - \Omega_{n-1,n} v_n + v_{n-1} + \left( \sum_{i=1}^n \Omega_{n,n-1} \Omega_{in} \right)^{-1} \left[  c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in}\right]
\\
& = - \Omega_{n-1,n} v_n + v_{n-1} + \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[  c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in}\right]
\\
& =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ - \Omega_{n-1,n} v_n \sum_{i=1}^n \Omega_{i, n-1} + v_{n-1} \sum_{i=1}^n \Omega_{i, n-1} + c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in} \right]
\\
& =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ - v_n \sum_{i=1}^n \Omega_{in} + v_{n-1} \sum_{i=1}^n \Omega_{i, n-1} + c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in} \right]
\\
&  =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ - v_n \sum_{i=1}^n \Omega_{in} + v_{n-1} \sum_{i=1}^n \Omega_{i, n-1} + c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in} \right]
\\
& =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ v_{n-1} \sum_{i=1}^n \Omega_{i, n-1} + c - \sum_{i=1}^{n-1} v_i + v_n \left( \sum_{i=1}^{n-1} \Omega_{in} - \sum_{i=1}^n \Omega_{in} \right) \right]
\end{align*}

At this point, we need to break steps down term by term. Note that the term in the parenthesis within the brackets equals -1, and that

\[
v_{n-1} \sum_{i=1}^n \Omega_{i, n-1} = v_{n-1} \left( 1 +\sum_{i \neq n-1} \Omega_{i, n-1} \right) =  v_{n-1} + v_{n-1} \sum_{i \neq n-1} \Omega_{i, n-1}
\]

 The lone \(v_{n-1}\) will cancel with the final term in the \( \sum_{i=1}^{n-1} v_i \) summation. This leaves us with
 
 \[
 p_{n-1} =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ v_{n-1} \sum_{i \neq n-1} \Omega_{i, n-1} + c - \sum_{i=1}^{n-2} v_i - v_n \right]
 \]
 
 Or
 
 \begin{equation}
 p_{n-1} =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ c - \sum_{i \neq n-1} v_i + v_{n-1} \sum_{i \neq n-1} \Omega_{i, n-1}  \right]
 \end{equation}

Our closed form solution to \(p_{n-1}\). Finally let's compare 7 to 6.

\begin{align*}
 &p_{n-1} =  \left( \sum_{i=1}^n \Omega_{i, n-1} \right)^{-1} \left[ c - \sum_{i \neq n-1} v_i + v_{n-1} \sum_{i \neq n-1} \Omega_{i, n-1}  \right]
\\
&p_n = \left( \sum_{i=1}^n \Omega_{in} \right)^{-1} \left[  c - \sum_{i=1}^{n-1} v_i + v_n \sum_{i=1}^{n-1} \Omega_{in}\right]
\end{align*}

From the above pattern, it's clear that the closed form solution for any \(p_j\) is

\begin{equation}
p_j =  \left( \sum_{i=1}^n \left( \frac{\beta_i}{\beta_j}\right)^\sigma \right)^{-1} \left[ c - \sum_{i \neq j} v_i + v_j \sum_{i \neq j} \left( \frac{\beta_i}{\beta_j}\right)^\sigma  \right]
\end{equation}

Inside the brackets, add \(0 = v_j \left( \frac{\beta_j}{\beta_j}\right)^\sigma - v_j\) and rearrange to get:

\begin{equation}
p_j =  v_j - \frac{\beta_j\strut^\sigma}{\sum_{i=1}^n \beta_i\strut^\sigma} \left[  \sum_{i =1}^n (v_i)  - c \right]
\end{equation}

\begin{thebibliography}{1}

\bibitem{} Chen, Yan. "A family of supermodular Nash mechanisms implementing Lindahl allocations." Economic Theory 19.4 (2002): 773-790.

\bibitem{} Diamantaras, Dimitrios, and Robert P. Gilles. "The pure theory of public goods: efficiency, decentralization, and the core." International Economic Review (1996): 851-860.

\bibitem{} Foley, Duncan K. "Lindahl's Solution and the Core of an Economy with Public Goods." Econometrica: Journal of the Econometric Society (1970): 66-72.

\bibitem{} Groves, Theodore, and John Ledyard. "Optimal allocation of public goods: A solution to the" free rider" problem." Econometrica: Journal of the Econometric Society (1977): 783-809.

\bibitem{} Healy, Paul J., and Laurent Mathevet. "Designing stable mechanisms for economic environments." Theoretical economics 7.3 (2012): 609-661.

\bibitem{} Hurwicz, Leonid. "Outcome functions yielding Walrasian and Lindahl allocations at Nash equilibrium points." The Review of Economic Studies 46.2 (1979): 217-225.

\bibitem{} Kaneko, Mamoru. "The ratio equilibrium and a voting game in a public goods economy." Journal of Economic Theory 16.2 (1977): 123-136.

\bibitem{} Lindahl, Erik. "Just taxation—a positive solution." Classics in the theory of public finance. Palgrave Macmillan, London, 1958. 168-176.

\bibitem{} Mas-Colell, Andreu. "Efficiency and decentralization in the pure theory of public goods." The Quarterly Journal of Economics 94.4 (1980): 625-641.

\bibitem{} Mathevet, Laurent. "Supermodular mechanism design." Theoretical Economics 5.3 (2010): 403-443.

\bibitem{} Mas-Colell, Andreu, and Joaquim Silvestre. "Cost share equilibria: A Lindahlian approach." Journal of Economic Theory 47.2 (1989): 239-256.

\bibitem{} Milgrom, Paul, and John Roberts. "Rationalizability, learning, and equilibrium in games with strategic complementarities." Econometrica: Journal of the Econometric Society (1990): 1255-1277.

\bibitem{} Van Essen, Matthew J. "A simple supermodular mechanism that implements Lindahl allocations." Journal of Public Economic Theory 15.3 (2013): 363-377.

\bibitem Varian, Hal R. "A solution to the problem of externalities when agents are well-informed." The American Economic Review (1994): 1278-1293.

\bibitem{} Varian, Hal R. "Sequential contributions to public goods." Journal of Public Economics 53.2 (1994): 165-186.

\bibitem{} Walker, Mark. "A simple incentive compatible scheme for attaining Lindahl allocations." Econometrica: Journal of the Econometric Society (1981): 65-71.

\bibitem{} Wicksell, Knut. "A new principle of just taxation." Classics in the theory of public finance. Palgrave Macmillan, London, 1958. 72-118.


\end{thebibliography}

\end{document}